@page "/log"
@page "/log/{TaskId}"
@page "/log/{Service}/{StartTime}/{EndTime}/{Keyword}"
@inject I18n I18n
@inject NavigationManager NavigationManager

<PageTitle>@I18n.Log("Log")</PageTitle>

<LogPanel PageMode=true TaskId="@TaskId" StartTime="ToDateTime(StartTime)" EndTime="ToDateTime(EndTime)" Service="@Service" Keyword="@Keyword" />

@code {

    /// <summary>
    /// scheduler job taskId
    /// </summary>
    [Parameter]
    public string TaskId { get; set; }

    [Parameter]
    public string StartTime { get; set; }

    [Parameter]
    public string EndTime { get; set; }

    [Parameter]
    public string Service { get; set; }

    [Parameter]
    public string Keyword { get; set; }

    DateTime ToDateTime(string str)
    {
        if (DateTime.TryParse(str, out var time))
            return time;
        return DateTime.MinValue;
    }

    protected override void OnInitialized()
    {
        if (!string.IsNullOrEmpty(Keyword))
            Keyword = Keyword.Replace('。', '.');
        base.OnInitialized();
    }
}