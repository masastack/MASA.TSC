@page "/dashboard/configuration/record"
@page "/dashboard/configuration/{dashboardId}"
@inherits TscComponentBase

<AutoHeight Overflow AutoStyle="max-height: calc(100vh - 185px);height: 900px">
    <HeaderContent>
        <div class="d-flex mb-6">
            <AppAutoComplete @bind-Value="@ConfigurationRecord.AppName" FillBackground=false Class="mr-6 my-auto" Style="max-width:300px !important;width:300px;" />
            <div style="width:100%;" class="d-flex">
                <SearchTextField @bind-Value="@ConfigurationRecord.Search" FillBackground=false Clearable Class="mr-6 my-auto" />
                <DateTimeRangeToolbar Class="mr-6 my-auto" DefaultQuickRange="QuickRangeKey.Last15Minutes" OnUpdate="OnDateTimeUpdateAsync" />
            </div>
            <MSwitch @bind-Value="IsEdit" LeftText="@T("V")" RightText="@T("E")" HideDetails="@("auto")" TrackColor="white" Color="primary" Class="mr-6 my-auto" />
            @if (IsEdit)
            {
                <SButton Icon Class="mr-3 my-auto" OnClick="() => AddPanel()">
                    <SIcon Tooltip="@T("Add Panel")" Size=28>@IconConstants.Chart</SIcon>
                </SButton>
                <SButton Icon Class="my-auto" OnClick="SaveAsync">
                    <SIcon Tooltip="@T("Save")" Size=28>@IconConstants.Save</SIcon>
                </SButton>
            }
        </div>
    </HeaderContent>
    <AutoHeightContent>
        @if(string.IsNullOrEmpty(ConfigurationRecord.DashboardId) is false)
        {
            <DefaultCard Style="min-height: calc(100vh - 185px);    ">
                <CascadingValue Value="IsEdit">
                    <CascadingValue Value="PanelGrids" IsFixed>
                        <CascadingValue Value="ConfigurationRecord">
                            @if(ConfigurationRecord.Panels.Any())
                            {
                                <PanelGrids Panels="ConfigurationRecord.Panels" />
                            }
                        </CascadingValue>
                    </CascadingValue>
                </CascadingValue>
            </DefaultCard>
        }
    </AutoHeightContent>
</AutoHeight>