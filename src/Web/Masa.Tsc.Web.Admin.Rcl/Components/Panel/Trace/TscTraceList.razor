@namespace Masa.Tsc.Web.Admin.Rcl.Components
@inherits TscComponentBase

<SDataTable Headers="_headers"
            ServerItemsLength="_total"
            ItemsPerPage="_pageSize"
            Items="_data"
            TItem="TraceResponseDto"
            Loading="@Loading"
            Height='"calc(100vh - 605px)"' SortBy="_sortBy" SortDesc="_sortDesc" OnOptionsUpdate="OnOptionsUpdate">
    <ItemColContent>
        <div class="hover-pointer" @onclick="e=> OpenAsync(context.Item)">
            @if (context.Header.Value == "Operate")
            {
                <MIcon OnClick="@(() => OpenAsync(context.Item))">mdi-view-headline</MIcon>
            }
            else if (context.Header.Text == "Timestamp")
            {
                @(context.Item.Timestamp.Format(CurrentTimeZone))
            }
            else if (context.Header.Text == "Service")
            {
                @context.Item.Resource["service.name"]
            }
            else if (context.Header.Text == "Endpoint")
            {
                @context.Item.GetDispalyName()
            }
            else
            {
                @context.Value
            }
        </div>
    </ItemColContent>
</SDataTable>

<MCard Rounded=true Class="px-6 py-2" Style="border-top-left-radius: 0 !important; border-top-right-radius: 0 !important;">
    <SPagination Class="mt-2" @bind-Page="_page" @bind-PageSize=_pageSize Total=_total OnChange="HandleOnPaginationUpdate" />
</MCard>
<TscTraceDetail Title="@CurrentTrace?.Resource["service.name"]?.ToString()" @ref="_tscTraceDetail"></TscTraceDetail>